<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verifica√ß√£o IRT - Angola 2025</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        .teste {
            margin: 15px 0;
            padding: 15px;
            background: #2d2d2d;
            border-left: 4px solid #007acc;
        }
        .passou { border-left-color: #4ec9b0; }
        .falhou { border-left-color: #f48771; }
        .titulo {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .detalhes {
            font-size: 14px;
            line-height: 1.6;
            margin-left: 20px;
        }
        .valor {
            color: #4ec9b0;
            font-weight: bold;
        }
        .erro {
            color: #f48771;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>üîç Verifica√ß√£o da Tabela IRT Angola 2025</h1>
    <div id="resultados"></div>

    <script src="js/calculo-salario.js"></script>
    <script>
        const testes = [
            { 
                vb: 100000, 
                nome: '100.000 AKZ', 
                escalaoEsperado: '1¬∫ Escal√£o (Isento)',
                irtEsperado: 0 
            },
            { 
                vb: 150000, 
                nome: '150.000 AKZ', 
                escalaoEsperado: '2¬∫ Escal√£o',
                irtEsperado: 4550 
            },
            { 
                vb: 300000, 
                nome: '300.000 AKZ', 
                escalaoEsperado: '4¬∫ Escal√£o',
                irtEsperado: 26060 
            },
            { 
                vb: 1000000, 
                nome: '1.000.000 AKZ', 
                escalaoEsperado: '8¬∫ Escal√£o',
                irtEsperado: 168500 
            },
            { 
                vb: 2500000, 
                nome: '2.500.000 AKZ', 
                escalaoEsperado: '11¬∫ Escal√£o',
                irtEsperado: 536250 
            }
        ];

        const resultadosDiv = document.getElementById('resultados');
        let todosPassaram = true;

        testes.forEach(teste => {
            const resultado = CalculadoraSalario.calcular(teste.vb, 0, 0);
            
            // Toler√¢ncia de 1 AKZ para diferen√ßas de arredondamento
            const diferenca = Math.abs(resultado.irt - teste.irtEsperado);
            const passou = diferenca < 1;
            
            if (!passou) todosPassaram = false;

            const div = document.createElement('div');
            div.className = `teste ${passou ? 'passou' : 'falhou'}`;
            
            div.innerHTML = `
                <div class="titulo">
                    ${passou ? '‚úÖ' : '‚ùå'} ${teste.nome}
                </div>
                <div class="detalhes">
                    <strong>Vencimento Base:</strong> <span class="valor">${CalculadoraSalario.formatarValor(teste.vb)}</span><br>
                    <strong>INSS (3%):</strong> <span class="valor">${CalculadoraSalario.formatarValor(resultado.inss)}</span><br>
                    <strong>Mat√©ria Colect√°vel:</strong> <span class="valor">${CalculadoraSalario.formatarValor(resultado.materiaColectavel)}</span><br>
                    <strong>Escal√£o:</strong> ${resultado.escalaoIRT} ${teste.escalaoEsperado && !resultado.escalaoIRT.includes(teste.escalaoEsperado) ? '<span class="erro">(esperado: ' + teste.escalaoEsperado + ')</span>' : ''}<br>
                    <strong>IRT Calculado:</strong> <span class="${passou ? 'valor' : 'erro'}">${CalculadoraSalario.formatarValor(resultado.irt)}</span><br>
                    <strong>IRT Esperado:</strong> <span class="valor">${CalculadoraSalario.formatarValor(teste.irtEsperado)}</span><br>
                    ${!passou ? `<strong>Diferen√ßa:</strong> <span class="erro">${CalculadoraSalario.formatarValor(diferenca)}</span><br>` : ''}
                    <strong>L√≠quido Final:</strong> <span class="valor">${CalculadoraSalario.formatarValor(resultado.liquido)}</span>
                </div>
            `;
            
            resultadosDiv.appendChild(div);
        });

        // Resumo final
        const resumo = document.createElement('div');
        resumo.style.marginTop = '30px';
        resumo.style.padding = '20px';
        resumo.style.background = todosPassaram ? '#0e4429' : '#3d1f1f';
        resumo.style.borderLeft = `4px solid ${todosPassaram ? '#4ec9b0' : '#f48771'}`;
        resumo.style.fontSize = '18px';
        resumo.innerHTML = `
            <strong>${todosPassaram ? '‚úÖ TODOS OS TESTES PASSARAM!' : '‚ùå ALGUNS TESTES FALHARAM'}</strong><br>
            <span style="font-size: 14px; opacity: 0.8;">
                ${todosPassaram ? 'A tabela IRT est√° correta e pronta para uso.' : 'As taxas ou parcelas a abater precisam de ajuste.'}
            </span>
        `;
        resultadosDiv.appendChild(resumo);
    </script>
</body>
</html>
